<?xml version="1.0" encoding="UTF-8"?>
<project default="plugin_export" name="TOD plugin">
	
	
    <target name="init">
    	<property name="build.dir" value="${basedir}/build"/>
        <property name="tod.dir" value="${basedir}/../TOD"/>
        <property name="zz.utils.dir" value="${basedir}/../zz.utils"/>
        <property name="zz.csg.dir" value="${basedir}/../zz.csg"/>
    </target>
	
	<target name="plugin_export" depends="init, dep.all">
		<mkdir dir="${build.dir}"/>
		
		<pde.exportPlugins 
			destination="${build.dir}" 
			exportSource="false" 
			exportType="zip" 
			filename="tod.plugin.zip" 
			plugins="tod.plugin,zz.eclipse.utils" 
			useJARFormat="false"/>
	</target>
	
	<target name="dep.tod" depends="init">
		<ant antfile="${tod.dir}/build.xml" dir="${tod.dir}" target="jar"/>
		<copy todir="lib">
			<fileset dir="${tod.dir}/build" includes="tod-debugger.jar tod-agent.jar"/>
			<fileset dir="${tod.dir}" includes="libbci-agent.*"/>
		</copy>
	</target>
	
	<target name="dep.zz.utils" depends="init">
		<ant 
			antfile="${zz.utils.dir}/build.xml" 
			dir="${zz.utils.dir}" 
			target="jar"
			inheritall="false"/>
		<echo message="Finished building zz.utils"/>
		<copy todir="lib">
			<fileset dir="${zz.utils.dir}/build" includes="zz.utils.jar"/>
		</copy>
	</target>
	

	<target name="dep.zz.csg" depends="init">
		<ant 
			antfile="${zz.csg.dir}/build.xml" 
			dir="${zz.csg.dir}" 
			target="jar"
			inheritall="false"/>
		<copy todir="lib">
			<fileset dir="${zz.csg.dir}/build" includes="zz.csg.jar"/>
		</copy>
	</target>
	
	<target name="dep.all" depends="dep.tod, dep.zz.utils, dep.zz.csg"/>
</project>
